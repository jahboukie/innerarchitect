<!-- PWA Install Button Component -->
<div class="pwa-install-container my-4 d-none">
    <div class="card shadow-sm">
        <div class="card-body p-4">
            <div class="d-flex align-items-center">
                <div class="flex-shrink-0 me-3">
                    <img src="{{ url_for('static', filename='icons/icon-96x96.png') }}" alt="App Icon" width="48" height="48" class="rounded">
                </div>
                <div class="flex-grow-1">
                    <h5 class="card-title mb-1">{{ g.translate('install_app_title', 'Install The Inner Architect') }}</h5>
                    <p class="card-text text-muted small mb-0">
                        {{ g.translate('install_app_description', 'Add to your home screen for easier access') }}
                    </p>
                </div>
                <div class="flex-shrink-0 ms-3">
                    <button class="btn btn-primary pwa-install-button px-3 py-2">
                        <i class="fas fa-download me-2"></i> {{ g.translate('install_app_button', 'Install') }}
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const installContainer = document.querySelector('.pwa-install-container');
        
        // Only show the install button on supported browsers when not already installed
        if ('serviceWorker' in navigator && window.matchMedia('(display-mode: browser)').matches) {
            // This will become visible when the beforeinstallprompt event occurs
            // The event handling is in base.html
            
            // Check if on a standalone-capable platform (iOS, Android, desktop Chrome/Edge/etc)
            if (
                /android/i.test(navigator.userAgent) || 
                /iphone|ipad|ipod/i.test(navigator.userAgent) ||
                /chrome/i.test(navigator.userAgent) ||
                /edge/i.test(navigator.userAgent) ||
                /firefox/i.test(navigator.userAgent)
            ) {
                installContainer.classList.remove('d-none');
            }
        }
    });
</script>